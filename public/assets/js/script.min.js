$(document).ready((function(){$("[data-bs-hover-animate]").mouseenter((function(){var t=$(this);t.addClass("animated "+t.attr("data-bs-hover-animate"))})).mouseleave((function(){var t=$(this);t.removeClass("animated "+t.attr("data-bs-hover-animate"))}))}));var i,acc=document.getElementsByClassName("faq");for(i=0;i<acc.length;i++)acc[i].addEventListener("click",(function(){this.classList.toggle("on");var t=this.nextElementSibling;t.style.maxHeight?t.style.maxHeight=null:t.style.maxHeight=t.scrollHeight+"px"}));Chart.pluginService.register({beforeDraw:function(t){if(t.config.options.elements.center){var e=t.chart.ctx,i=t.config.options.elements.center,n=i.fontStyle||"Arial",a=i.text,s=i.color||"#000",o=i.maxFontSize||75,r=(i.sidePadding||20)/100*(2*t.innerRadius);e.font="30px "+n;var m=e.measureText(a).width,l=2*t.innerRadius-r,g=l/m,c=Math.floor(30*g),d=2*t.innerRadius,u=Math.min(c,d,o),h=i.minFontSize,D=i.lineHeight||25,S=!1;void 0===h&&(h=20),h&&u<h&&(u=h,S=!0),e.textAlign="center",e.textBaseline="middle";var y=(t.chartArea.left+t.chartArea.right)/2,F=(t.chartArea.top+t.chartArea.bottom)/2;if(e.font=u+"px "+n,e.fillStyle=s,!S)return void e.fillText(a,y,F);for(var p=a.split(" "),$="",x=[],f=0;f<p.length;f++){var b=$+p[f]+" ";e.measureText(b).width>l&&f>0?(x.push($),$=p[f]+" "):$=b}F-=x.length/2*D;for(f=0;f<x.length;f++)e.fillText(x[f],y,F),F+=D;e.fillText($,y,F)}}}),$(document).ready((function(){let t=!0,e="last24h",i=9999,n=9999,a=[],s=0,o=-1;void 0!==$.getUrlVar("s")?(e=$.getUrlVar("s"),"last24h"==e&&$("#selectorLabel").html("Die letzten 24 Stunden"),"last7d"==e&&$("#selectorLabel").html("Die letzten 7 Tage"),"last30d"==e&&$("#selectorLabel").html("Die letzten 30 Tage"),"last365d"==e&&$("#selectorLabel").html("Die letzten 365 Tage")):$("#selectorLabel").html("Die letzten 24 Stunden");const r=function(){a.length>0?setTimeout((function(){s>=a.length&&(s=0),$("#infotext").html(a[s]),$("#info").addClass("in"),$("#info").removeClass("hide"),$("#info").addClass("show"),setTimeout((function(){$("#info").removeClass("show"),$("#info").addClass("hide"),r(),s++}),15e3)}),2500):($("#info").removeClass("show"),$("#info").addClass("hide"))},m=function(){if(void 0!==window.localStorage.getItem("msg")&&null!==window.localStorage.getItem("msg")){let s=JSON.parse(window.localStorage.getItem("msg"));i!==s.stats[e].energyPrice_kwh&&(9999!==i&&(i<s.stats[e].energyPrice_kwh&&($("#priceUp").show(),$("#priceDown").hide(),$("#energyPrice_kwh").addClass("corrently_orange"),$("#energyPrice_kwh").removeClass("corrently_green")),i>s.stats[e].energyPrice_kwh&&($("#priceUp").hide(),$("#priceDown").show(),$("#energyPrice_kwh").removeClass("corrently_orange"),$("#energyPrice_kwh").addClass("corrently_green"))),i=s.stats[e].energyPrice_kwh),n!==s.stats[e].incomeSaldo&&(9999!==n&&(n<s.stats[e].incomeSaldo&&($("#costDown").show(),$("#costUp").hide(),$("#incomeSaldo").addClass("corrently_green"),$("#incomeSaldo").removeClass("corrently_orange")),n>s.stats[e].incomeSaldo&&($("#costDown").hide(),$("#costUp").show(),$("#incomeSaldo").addClass("corrently_orange"),$("#incomeSaldo").removeClass("corrently_green"))),n=s.stats[e].incomeSaldo),$("#energyPrice_kwh").html((100*s.stats[e].energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#last24h").html((100*s.stats.last24h.energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#last7d").html((100*s.stats.last7d.energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#last30d").html((100*s.stats.last30d.energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#last365d").html((100*s.stats.last365d.energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$(".updateTS").html(new Date(s.time).toLocaleString()),$("#e24h").html(s.stats.last24h.energyRevenue.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#e7d").html(s.stats.last7d.energyRevenue.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#e30d").html(s.stats.last30d.energyRevenue.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#e365d").html(s.stats.last365d.energyRevenue.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#a24h").html(s.stats.last24h.energySpendings.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#a7d").html(s.stats.last7d.energySpendings.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#a30d").html(s.stats.last30d.energySpendings.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#a365d").html(s.stats.last365d.energySpendings.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#incomeSaldo").html((-1*s.stats[e].incomeSaldo).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#s24h").html((-1*s.stats.last24h.incomeSaldo).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#s7d").html((-1*s.stats.last7d.incomeSaldo).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#s30d").html((-1*s.stats.last30d.incomeSaldo).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#s365d").html((-1*s.stats.last365d.incomeSaldo).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})),document.title=(100*s.stats[e].energyPrice_kwh).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})+"/kWh "+(-1*s.stats[e].incomeSaldo).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})+"/Tag";let m=$("#einnahmenChart"),l=[],g=[];l.push(s.stats[e].energySavingsSelf),g.push("Eigenstrom"),l.push(s.stats[e].energyIncome),g.push("Einspeisung"),l.push(s.stats[e].correntlyIncome),g.push("Corrently Erzeugung");new Chart(m,{type:"doughnut",data:{datasets:[{label:"Einnahmen Verteilung",data:l,backgroundColor:["#006c32","#318b4e","#86df9b"]}],labels:g},options:{responsive:!0,legend:{position:"right"},plugins:{datalabels:{display:!0}},title:{display:!1,text:""},animation:{animateScale:t,animateRotate:t},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(t,e){return g[t.index]+": "+e.datasets[0].data[t.index]+"€"}}},elements:{center:{text:s.stats[e].energyRevenue.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2}),color:"#006C32",fontStyle:"Arial",sidePadding:20,minFontSize:20,lineHeight:25}}}});let c=$("#ausgabenChart"),d=[],u=[];d.push(s.stats[e].energyCost),u.push("Strombezug"),d.push(s.stats[e].amortization),u.push("Abschreibung"),d.push(s.stats[e].baseCosts),u.push("Grundgebühr");new Chart(c,{type:"doughnut",data:{datasets:[{label:"Ausgaben Verteilung",data:d,backgroundColor:["#FFA700","#FF8922","#FFF6E4"]}],labels:u},options:{responsive:!0,legend:{position:"left"},plugins:{datalabels:{display:!0}},title:{display:!1,text:""},animation:{animateScale:t,animateRotate:t},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(t,e){return u[t.index]+": "+e.datasets[0].data[t.index]+"€"}}},elements:{center:{text:s.stats[e].energySpendings.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2}),color:"#FFA700",fontStyle:"Arial",sidePadding:20,minFontSize:20,lineHeight:25}}}});t=!1;let h=s.stats[e].consumption_wh*s.meterinfo.energyPriceWh+s.stats[e].baseCosts,D=Math.round(1e4*(1- -1*s.stats[e].incomeSaldo/h))/100;-1==o&&(a.push("<strong>Ausgaben:</strong><br/>  "+Math.round(s.stats[e].energyCost/s.stats[e].energySpendings*100)+"% der Kosten von "+s.stats[e].energySpendings.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})+"€ für die Stromversorgung sind variabel, d.h. können durch den Verbrauch unmittelbar beeinflusst werden."),a.push("<strong>Einnahmen:</strong><br/> Steigere den Netzbezug zu Zeiten mit einem hohen Werten des GrünstromIndex, um die Erträge aus Corrently Erzeugung von derzeit "+s.stats[e].correntlyIncome.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})+"€ zu eröhen."),o=setTimeout(r,2500),a.push("<strong>Ersparnis:</strong><br/>"+D+"% im Vergleich zu einem klassischen Anschluss ohne Erzeugung und Corrently."))}},l=function(){$.getJSON("/msg",(function(t){window.localStorage.setItem("msg",JSON.stringify(t)),m()}))};m(),setInterval(l,1e4),l()}));